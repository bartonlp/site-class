<!DOCTYPE html>
<html>
<head>
<style>
pre {
background-color: #DBDBDB;
overflow: auto;
}
</style>
</head>
<body>
<h1 id="siteclass">SiteClass</h1>
<p><strong>SiteClass</strong> is a PHP mini framework for simple, small websites. It can be esaly combined with other frameworks or templeting engines if needed. For small websites I feel that frameworks like Laravel or Meteor etc. are just too much.</p>
<p>This project has several parts that can function standalone or combined.</p>
<ul>
<li>siteautoload.class.php : Autoload classes and reads a .sitemap.php file to initialize the system.<br /></li>
<li>Database.class.php : provides a wrapper for several different database engines.<br /></li>
<li>dbTables.class.php : uses the functionality of Database.class.php to make creating tables easy.<br /></li>
<li>Error and Exception classes<br /></li>
<li>SiteClass.class.php : tools for making creating a site a little easier. The class provides methods to help with headers, banners, footers and more.</li>
</ul>
<p>The following database engines are provided as the following classes:</p>
<ol>
<li>dbMysql (depreciated)<br /></li>
<li>dbMysqli (most rigorously tested)<br /></li>
<li>dbSqlite sqlite3 (used for the examples)<br /></li>
<li>dbPod PHP POD, works with 'pdo_sqlite' and 'pdo_pgsql'<br /></li>
<li>dbPostgreSql (new and lest tested but works with 'test.php'</li>
</ol>
<h2 id="disclamer">Disclamer</h2>
<p>To start, this framework is meant for Linux not Windows. I don't use Windows, like it or have it, so nothing has been tried on Windows.</p>
<p>I use Linux Mint which is an Ubuntu derivative which is a Debian derivative. I have not tried this package on any distributions that do not evolve from Debian.</p>
<h2 id="install">Install</h2>
<p>There are several ways to install this project.</p>
<h3 id="download-the-zip-file">Download The ZIP File</h3>
<p>Download the ZIP file from GitHub. Expand it and move the 'includes' directory somewhere. On a system with Apache2 I usually put the 'includes' directory in the /var/www directory that Apache creates. Apache also usually creates /var/www/html and makes this the default DocumentRoot. I put the 'includes' directory just outside of the DocumentRoot. In my servers I have /var/www and then have my virtual hosts off that directory. That way the 'includes' directory is easily available to all of my virtual hosts.</p>
<p>If you are testing with the PHP server I put a 'www' directory off my $HOME and put the 'includes' directory there. I then make my test DocumentRoot off '~/www' like '~/www/test'. I <code>cd</code> to the test directory and do <code>php -S localhost:8080</code>. I can then use my browser and goto <code>localhost:8080</code> and see my 'index.php' file.</p>
<h3 id="use-composer">Use Composer</h3>
<p>If you have Apache or Nginx installed then you should made your project root somewhere withing your DocumentRoot ('/var/www/html' for Apache2 on Ubuntu).</p>
<p>Create a directory <code>mkdir myproject; cd myproject</code>, this is your project root directory. Add the following to 'composer.json', just cut and past:</p>
<pre><code>{
  &quot;require&quot;: {
      &quot;bartonlp/site-class&quot;: &quot;dev-master&quot;
  }
}</code></pre>
<p>Then run</p>
<pre><code>composer install</code></pre>
<p><strong>OR</strong> you can just run</p>
<pre><code>composer require bartonlp/site-class:dev-master</code></pre>
<p>which will create the 'composer.json' for you and load the package like 'install'.</p>
<p>In your PHP file add <code>require_once($PATH . 'vendor/autoload.php');</code> where '$PATH' is the path to the 'vendor' directory like './' or '../' etc.</p>
<p>There are some example files in the 'examples' directory at '/vendor/bartonlp/site-class/examples' or 'examples' in your project root if you copied it there.</p>
<h2 id="examples">Examples</h2>
<p>The code shown below can be found in the 'examples' directory at <a href="http://github.com/bartonlp/site-class">http://github.com/bartonlp/site-class</a> or from your project root at 'vendor/bartonlp/site-class/examples' along with more <a href="examples/EXAMPLES.html">documentation</a>.</p>
<p style="color: green">The code in the 'examples' directory has actually been tested and runs. The code in this README was originally copied in from the examples code but may have changed for some reason. Therefore you should use the examples code rather than doing a copy and past from this README.</p>


<p>If you have Apache or Nginx installed then you should have made your project root somewhere within your DocumentRoot, for example '/var/www/html/myproject'.</p>
<p>If you don't have Apache or Nginx installed on your computer you can use the PHP server. Do the following from your project root:</p>
<pre><code>php -S localhost:8080</code></pre>
<p>Then use your browser by entering <code>http://localhost:8080/README.html</code> in the browsers location bar.</p>
<p>The code in the 'examples' directory uses the <strong>sqlite3</strong> engine. There should be a 'test.sdb' database file in the 'examples' directory already.</p>
<p>I have included a 'sqlite.sql' file that can be run from the command line if you want to recreate the 'members' table.</p>
<p>You will need to get sqlite3 and get the PHP sqlite packages along with mysql etc. From the command line in the directory where the SiteClass was downloaded:</p>
<pre><code>$ cd examples
$ sqlite3 test.sdb
sqlite&gt; drop table members;
sqlite&gt; .read sqlite.sql
sqlite&gt; .table
members
sqlite&gt; select rowid,* from members;
1|Big|Joe
2|Little|Joe
3|Barton|Phillips
4|Someone|Else
sqlite&gt; .quit
$</code></pre>
<p>This should create a new 'members' table in the 'test.sdb' database.</p>
<hr>


<p>These examples assume that the 'includes' directory is at /var/www as I suggested. The files in the 'examples' directory use either '../vendor/bartonlp/site-class/includes' or '../vendor/autoload.php' for the 'composer-' variants. The examples assume that you have copied the 'examples' directory from the 'vendor/bartonlp/site-class' directory to your project root.</p>
<p>There are a number of ways to use the framework:</p>
<p><strong>First</strong> you can just use the SiteClass all by itself.</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="co">// test1.php</span>

<span class="kw">require</span>-once<span class="ot">(</span><span class="st">&#39;/var/www/includes/SiteClass.class.php&#39;</span><span class="ot">);</span> <span class="co">// path to your SiteClass.class.php file.</span>

<span class="kw">$siteinfo</span> = <span class="fu">array</span><span class="ot">(</span>
  <span class="st">&#39;siteDomain&#39;</span> =&gt; <span class="st">&quot;localhost&quot;</span><span class="ot">,</span>
  <span class="st">&#39;siteName&#39;</span> =&gt; <span class="st">&quot;Vbox Localhost&quot;</span><span class="ot">,</span>
  <span class="st">&#39;copyright&#39;</span> =&gt; <span class="st">&quot;2015 Barton L. Phillips&quot;</span><span class="ot">,</span>
<span class="ot">);</span>

<span class="kw">$S</span> = <span class="kw">new</span> SiteClass<span class="ot">(</span><span class="kw">$siteinfo</span><span class="ot">);</span>

<span class="fu">list</span><span class="ot">(</span><span class="kw">$top</span><span class="ot">,</span> <span class="kw">$footer</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;getPageTopBottom<span class="ot">();</span>
<span class="fu">echo</span> <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="kw">$top</span>
<span class="st">&lt;h1&gt;Test 1&lt;/h1&gt;</span>
<span class="st">&lt;p&gt;Stuff&lt;/p&gt;</span>
<span class="kw">$footer</span>
<span class="kw">EOF;</span></code></pre>
<p>That is the simplest usage. You get a generic &lt;head&gt; a blank &lt;header&gt; and a generic &lt;footer&gt;. No database or other stuff.</p>
<hr>


<p>You can extend this by adding a database either by instantiating the Database class directly or indirectly.</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="co">// test2.php</span>

<span class="kw">require</span>-once<span class="ot">(</span><span class="st">&#39;/var/www/includes/SiteClass.class.php&#39;</span><span class="ot">);</span> <span class="co">// path to your SiteClass.class.php file.</span>

<span class="kw">$siteinfo</span> = <span class="fu">array</span><span class="ot">(</span>
  <span class="st">&#39;siteDomain&#39;</span> =&gt; <span class="st">&quot;localhost&quot;</span><span class="ot">,</span>
  <span class="st">&#39;siteName&#39;</span> =&gt; <span class="st">&quot;Vbox Localhost&quot;</span><span class="ot">,</span>
  <span class="st">&#39;copyright&#39;</span> =&gt; <span class="st">&quot;2015 Barton L. Phillips&quot;</span><span class="ot">,</span>
  <span class="st">&#39;memberTable&#39;</span> =&gt; <span class="st">&#39;members&#39;</span><span class="ot">,</span>
  <span class="co">// Add dbinfo to the $siteinfo and SiteClass will instantiate the Database</span>
  <span class="st">&#39;dbinfo&#39;</span> =&gt; <span class="fu">array</span><span class="ot">(</span>
    <span class="st">&#39;database&#39;</span> =&gt; <span class="st">&#39;test.sdb&#39;</span><span class="ot">,</span>
    <span class="st">&#39;engine&#39;</span> =&gt; <span class="st">&#39;sqlite3&#39;</span>
  <span class="ot">),</span>
<span class="ot">);</span>

<span class="kw">$S</span> = <span class="kw">new</span> SiteClass<span class="ot">(</span><span class="kw">$siteinfo</span><span class="ot">);</span>

<span class="fu">list</span><span class="ot">(</span><span class="kw">$top</span><span class="ot">,</span> <span class="kw">$footer</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;getPageTopBottom<span class="ot">();</span>

<span class="co">// Do some database operations</span>

<span class="kw">$S</span>-&gt;query<span class="ot">(</span><span class="st">&quot;select fname||&#39; &#39;||lname) from </span><span class="kw">{$siteinfo[&#39;memberTable&#39;]}</span><span class="st">&quot;</span><span class="ot">;</span>
<span class="kw">$names</span> = <span class="st">&#39;&#39;</span><span class="ot">;</span>

<span class="kw">while</span><span class="ot">(</span><span class="fu">list</span><span class="ot">(</span><span class="kw">$name</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;fetchrow<span class="ot">(</span><span class="st">&#39;num&#39;</span><span class="ot">))</span> {
  <span class="kw">$names</span> .= <span class="st">&quot;</span><span class="kw">$name</span><span class="st">&lt;br&gt;&quot;</span><span class="ot">;</span>
}

<span class="fu">echo</span> <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="kw">$top</span>
<span class="st">&lt;h1&gt;Test 2&lt;/h1&gt;</span>
<span class="st">&lt;p&gt;</span><span class="kw">$names</span><span class="st">&lt;/p&gt;</span>
<span class="kw">$footer</span>
<span class="kw">EOF;</span></code></pre>
<p>The above example uses the 'query' and 'fetchrow' methods to do some database operations.</p>
<hr>


<p>The database could also be instantiated explicitly as follows:</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="co">// test3.php</span>

<span class="kw">require</span>-once<span class="ot">(</span><span class="st">&#39;/var/www/includes/SiteClass.class.php&#39;</span><span class="ot">);</span> <span class="co">// path to your SiteClass.class.php file.</span>

<span class="kw">$siteinfo</span> = <span class="fu">array</span><span class="ot">(</span>
  <span class="st">&#39;siteDomain&#39;</span> =&gt; <span class="st">&quot;localhost&quot;</span><span class="ot">,</span>
  <span class="st">&#39;siteName&#39;</span> =&gt; <span class="st">&quot;Vbox Localhost&quot;</span><span class="ot">,</span>
  <span class="st">&#39;copyright&#39;</span> =&gt; <span class="st">&quot;2015 Barton L. Phillips&quot;</span><span class="ot">,</span>
  <span class="st">&#39;memberTable&#39;</span> =&gt; <span class="st">&#39;members&#39;</span><span class="ot">,</span>
<span class="ot">);</span>

<span class="kw">$dbinfo</span> = <span class="fu">array</span><span class="ot">(</span>
  <span class="st">&#39;database&#39;</span> =&gt; <span class="st">&#39;test.sdb&#39;</span><span class="ot">,</span>
  <span class="st">&#39;engine&#39;</span> =&gt; <span class="st">&#39;mysqli&#39;</span>
<span class="ot">);</span>

<span class="kw">$siteifno</span><span class="ot">[</span><span class="st">&#39;databaseClass&#39;</span><span class="ot">]</span> = <span class="kw">new</span> Database<span class="ot">(</span><span class="kw">$dbinfo</span><span class="ot">);</span>

<span class="co">// by adding to the $siteinfo arrays &#39;databaseClass&#39; element we let SiteClass</span>
<span class="co">// know that the database is active.</span>

<span class="kw">$S</span> = <span class="kw">new</span> SiteClass<span class="ot">(</span><span class="kw">$siteinfo</span><span class="ot">);</span>

<span class="fu">list</span><span class="ot">(</span><span class="kw">$top</span><span class="ot">,</span> <span class="kw">$footer</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;getPageTopBottom<span class="ot">();</span>

<span class="co">// Do some database operations</span>

<span class="kw">$S</span>-&gt;query<span class="ot">(</span><span class="st">&quot;select fname||&#39; &#39;||lname from </span><span class="kw">{$siteinfo[&#39;memberTable&#39;]}</span><span class="st">&quot;</span><span class="ot">);</span>

<span class="kw">$names</span> = <span class="st">&#39;&#39;</span><span class="ot">;</span>

<span class="kw">while</span><span class="ot">(</span><span class="fu">list</span><span class="ot">(</span><span class="kw">$name</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;fetchrow<span class="ot">(</span><span class="st">&#39;num&#39;</span><span class="ot">))</span> {
  <span class="kw">$names</span> .= <span class="st">&quot;</span><span class="kw">$name</span><span class="st">&lt;br&gt;&quot;</span><span class="ot">;</span>
}

<span class="fu">echo</span> <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="kw">$top</span>
<span class="st">&lt;h1&gt;Test 3&lt;/h1&gt;</span>
<span class="st">&lt;p&gt;</span><span class="kw">$names</span><span class="st">&lt;/p&gt;</span>
<span class="st">&lt;hr&gt;</span>
<span class="kw">$footer</span>
<span class="kw">EOF;</span></code></pre>
<hr>


<p>You can also use the siteautoload.class.php and .sitemap.php to further automate working with the framework. There is a 'dot-sitemap.php.example' file that is well commented. Copy the file to your project directory as '.sitemap.php' and edit it to match your needs. There is already a .sitemap.php file in the 'examples' directory to see it you need to do <code>ls -a</code>.</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="co">// test4.php</span>

<span class="kw">require_once</span><span class="ot">(</span><span class="st">&#39;/var/www/includes/siteautoload.class.php&#39;</span><span class="ot">);</span> <span class="co">// path to siteautoload.class.php</span>
<span class="co">// the siteautoload.class.php first looks for the .sitemap.php file and then sets up class autoloader.</span>
<span class="co">// Now the class autoloader finds the classes that are required. The .sitemap.php has all the </span>
<span class="co">// information needed to instanntiate the Database class. The $siteinfo array is available for the</span>
<span class="co">// SiteClass etc.</span>

<span class="kw">$S</span> = <span class="kw">new</span> SiteClass<span class="ot">(</span><span class="kw">$siteinfo</span><span class="ot">);</span>

<span class="fu">list</span><span class="ot">(</span><span class="kw">$top</span><span class="ot">,</span> <span class="kw">$footer</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;getPageTopBottom<span class="ot">();</span>

<span class="co">// Do some database operations</span>

<span class="kw">$S</span>-&gt;query<span class="ot">(</span><span class="st">&quot;select concat(fname, &#39; &#39;, lname) from </span><span class="kw">{$siteinfo[&#39;memberTable&#39;]}</span><span class="st">&quot;</span><span class="ot">;</span>

<span class="kw">$names</span> = <span class="st">&#39;&#39;</span><span class="ot">;</span>

<span class="kw">while</span><span class="ot">(</span><span class="fu">list</span><span class="ot">(</span><span class="kw">$name</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;fetchrow<span class="ot">(</span><span class="st">&#39;num&#39;</span><span class="ot">))</span> {
  <span class="kw">$names</span> .= <span class="st">&quot;</span><span class="kw">$name</span><span class="st">&lt;br&gt;&quot;</span><span class="ot">;</span>
}

<span class="fu">echo</span> <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="kw">$top</span>
<span class="st">&lt;h1&gt;Test 4&lt;/h1&gt;</span>
<span class="st">&lt;p&gt;</span><span class="kw">$names</span><span class="st">&lt;/p&gt;</span>
<span class="kw">$footer</span>
<span class="kw">EOF;</span></code></pre>
<hr>


<p>In addition to the SiteClass and Database classes there are several others classes:</p>
<ul>
<li>Error<br /></li>
<li>SqlException<br /></li>
<li>dbMysql<br /></li>
<li>dbMysqli<br /></li>
<li>dbSqlite<br /></li>
<li>dbPod<br /></li>
<li>dbTables<br /></li>
<li>and a file with helper functions.</li>
</ul>
<hr>


<p>The dbTables class uses the Database class to make creating tables simple. For example:</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="kw">require_once</span><span class="ot">(</span><span class="st">&#39;/var/www/includes/siteautoload.class.php&#39;</span><span class="ot">);</span> <span class="co">// path to siteautoload.class.php</span>

<span class="kw">$S</span> = <span class="kw">new</span> SiteClass<span class="ot">(</span><span class="kw">$siteinfo</span><span class="ot">);</span>
<span class="kw">$T</span> = <span class="kw">new</span> dbTables<span class="ot">(</span><span class="kw">$S</span><span class="ot">);</span>

<span class="co">// Pass some info to getPageTopBottom method</span>

<span class="kw">$h</span>-&gt;title = <span class="st">&quot;Table Test 5&quot;</span><span class="ot">;</span> <span class="co">// Goes in the &lt;title&gt;&lt;/title&gt;</span>
<span class="kw">$h</span>-&gt;banner = <span class="st">&quot;&lt;h1&gt;Test 5&lt;/h1&gt;&quot;</span><span class="ot">;</span> <span class="co">// becomes the &lt;header&gt; section</span>

<span class="co">// Add some local css to but a border and padding on the table </span>

<span class="kw">$h</span>-&gt;css = <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="st">  &lt;style&gt;</span>
<span class="st">main table * {</span>
<span class="st">  padding: .5em;</span>
<span class="st">  border: 1px solid black;</span>
<span class="st">}</span>
<span class="st">  &lt;/style&gt;</span>
<span class="kw">EOF;</span>

<span class="fu">list</span><span class="ot">(</span><span class="kw">$top</span><span class="ot">,</span> <span class="kw">$footer</span><span class="ot">)</span> = <span class="kw">$S</span>-&gt;getPageTopBottom<span class="ot">(</span><span class="kw">$h</span><span class="ot">);</span>

<span class="co">// create a table from the memberTable</span>

<span class="kw">$sql</span> = <span class="st">&quot;select * from </span><span class="kw">{$siteinfo[&#39;memberTable&#39;]}</span><span class="st">&quot;</span><span class="ot">;</span>
<span class="fu">list</span><span class="ot">(</span><span class="kw">$tbl</span><span class="ot">)</span> = <span class="kw">$T</span>-&gt;maketable<span class="ot">(</span><span class="kw">$sql</span><span class="ot">);</span>
<span class="fu">echo</span> <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="kw">$top</span>
<span class="st">&lt;main&gt;</span>
<span class="st">&lt;h3&gt;Create a table from the members database table&lt;/h3&gt;</span>
<span class="st">&lt;p&gt;The members table follows:&lt;/p&gt;</span>
<span class="kw">$tbl</span>
<span class="st">&lt;/main&gt;</span>
<span class="st">&lt;hr&gt;</span>
<span class="kw">$footer</span>
<span class="kw">EOF;</span></code></pre>
<p>The maketable method takes several optional arguments (options) to help setup the table. Using the options you can give your table an id or class or set any other attributes. You can also pass a 'callback' function which can modify the rows as they are selected (see the 'insert-update.php' file in the 'examples' directory for more information).</p>
<hr>


<h2 id="the-dot-sitemap-file">The dot sitemap File</h2>
<p>The .sitemap.php file is the site configuration file. siteautoload.clas.php looks for the .sitemap.php file in the current directory. If it does not find it there it moves up to the parent directory. This continues until the DocumentRoot of the domain is reached. If a .sitemap.php file is not found an exception is thrown.</p>
<p>Once a .sitemap.php file is found the information in it is read in via 'require_once'. There are several section to the .sitemap.php file. The first section defines the layout of the directorys. The second section defines some email information used to send error messages (if these are not present then no emails are sent). The third section sets up the $siteinfo array. This array describes your site or page.</p>
<p>My usual directory structure starts under a 'www' subdirectory. On an Apache2 host the structure looks like this:</p>
<pre><code>/var/www/includes        // this is where the SiteClass resides
/var/www/html            // this is where your php files and js, css etc. 
                         // directories live
/var/www/html/includes   // this is where &#39;headFile&#39;, &#39;bannerFile&#39;, 
                         // &#39;footerFile&#39; and child classes live
/var/www/html/otherstuff // other directories. 
                         // These directories can have their own 
                         // .sitemap.php files</code></pre>
<p>If I have multiple virtual hosts they are all off the '/var/www' directory instead of a single 'html' directory.</p>
<h3 id="how-the-xxxfile-files-look">How the xxxFile files look</h3>
<p>In the .sitemap.php's $siteinfo array there can be three elements that describe the location of special files. These files are 1) 'headFile', 2) 'bannerFile' and 3) 'footerFile'.</p>
<p>I put the three special file in my '/var/www/html/includes' directory (where 'html' may be one of your virtual hosts and not named 'html').</p>
<p>Here is an example of my 'headFile':</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="co">// head.i.php for bartonphillips.com</span>

<span class="kw">$pageHeadText</span> = <span class="kw">&lt;&lt;&lt;EOF</span>
<span class="st">&lt;head&gt;</span>
<span class="st">  &lt;title&gt;</span><span class="kw">{$arg[&#39;title&#39;]}</span><span class="st">&lt;/title&gt;</span>
<span class="st">  &lt;!-- METAs --&gt;</span>
<span class="st">  &lt;meta name=viewport content=&quot;width=device-width, initial-scale=1&quot;&gt;</span>
<span class="st">  &lt;meta charset=&#39;utf-8&#39;/&gt;</span>
<span class="st">  &lt;meta name=&quot;copyright&quot; content=&quot;</span><span class="kw">$this</span><span class="st">-&gt;copyright&quot;&gt;</span>
<span class="st">  &lt;meta name=&quot;Author&quot;</span>
<span class="st">    content=&quot;Barton L. Phillips, mailto:bartonphillips@gmail.com&quot;/&gt;</span>
<span class="st">  &lt;meta name=&quot;description&quot;</span>
<span class="st">    content=&quot;</span><span class="kw">{$arg[&#39;desc&#39;]}</span><span class="st">&quot;/&gt;</span>
<span class="st">  &lt;meta name=&quot;keywords&quot;</span>
<span class="st">    content=&quot;Barton Phillips, Granby, Applitec Inc., Rotary, Programming, Tips and tricks, blog&quot;/&gt;</span>
<span class="st">  &lt;!-- ICONS, RSS --&gt;</span>
<span class="st">  &lt;link rel=&quot;shortcut icon&quot; href=&quot;http://www.bartonphillips.org/favicon.ico&quot; /&gt;</span>
<span class="st">  &lt;link rel=&quot;alternate&quot; type=&quot;application/rss+xml&quot; title=&quot;RSS&quot; href=&quot;/rssfeed.xml&quot; /&gt;</span>
<span class="st">  &lt;!-- Custom CSS --&gt;</span>
<span class="st">  &lt;link rel=&quot;stylesheet&quot; href=&quot;css/blp.css&quot; title=&quot;blp default&quot; /&gt;</span>
<span class="kw">{$arg[&#39;link&#39;]}</span>
<span class="st">  &lt;!-- jQuery --&gt;</span>
<span class="st">  &lt;script src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="st">  &lt;script async src=&quot;js/tracker.js&quot;&gt;&lt;/script&gt;</span>
<span class="kw">{$arg[&#39;extra&#39;]}</span>
<span class="kw">{$arg[&#39;script&#39;]}</span>
<span class="kw">{$arg[&#39;css&#39;]}</span>
<span class="st">&lt;/head&gt;</span>
<span class="st">EOF;</span></code></pre>
<p>The $pageHeadText variable gets all of the &lt;head&gt; section code. The $arg array is created form the argument passed to the getPageTopBottom method. The getPageTopBottom method also has access to the SiteClass $this property.</p>
<p>You will see if you delve into the SiteClass code that many things can be passed to the getPageTopBottom method, and the various sub-methods, but the standard things are:</p>
<ul>
<li>title<br /></li>
<li>desc<br /></li>
<li>link<br /></li>
<li>extra<br /></li>
<li>script<br /></li>
<li>css</li>
</ul>
<p>As you saw in example 5 above (test5.php in the 'examples' directory) I passed a $h object to the SiteClass. For example it might look like this:</p>
<pre class="sourceCode php"><code class="sourceCode php">$h-&gt;title = &#39;my title&#39;;
$h-&gt;desc = &#39;This is the description&#39;;
$h-&gt;link = &#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;test.css&quot;&gt;&#39;;
$h-&gt;extra = &#39;&lt;!-- this can be anything from a meta, link, script etc --&gt;&#39;;
$h-&gt;script = &#39;&lt;script&gt; var a=&quot;test&quot;; &lt;/script&gt;&#39;;
$h-&gt;css = &#39;&lt;style&gt; /* some css */ #test { width: 10px; } &lt;/style&gt;&#39;;
$S = new SiteClass($h);</code></pre>
<p>As you can see in the 'headFile' example the $this can also be used as in $this-&gt;copyright. Any of the pulic, protected or private $this properties can be used in any of the special files as they are all included within SiteClass.class.php.</p>
<p>The other special files have similarities and have their own file variable:</p>
<ul>
<li>'bannerFile' : $pageBannerText<br /></li>
<li>'footerFile' : $pageFooterText</li>
</ul>
<p>As these special files are PHP files you can do anything else that you need to, including database queries. Just remember that you need to use $this. For example, to do a query do <code>$this-&gt;query($sql);</code> not <code>$S-&gt;query($sql);</code>. You can't use the variable from your project file that you created via the <code>$S = new SiteClass($h);</code> because it is NOT within scope.</p>
<p>I usually call these files 'head.i.php', 'banner.i.php' and 'footer.i.php' but you can name them anything you like. In the .sitemap.php $siteinfo array just add the full path to the file. For example:</p>
<pre class="sourceCode php"><code class="sourceCode php">$siteinfo = array(&#39;siteDomain&#39; =&gt; &quot;bartonphillips.com&quot;,
                  &#39;siteName&#39; =&gt; &quot;My Home Page&quot;,
                  &#39;copyright&#39; =&gt; &quot;2015 Barton L. Phillips&quot;,
                  //&#39;className&#39; =&gt; &quot;&quot;, // if you have sub-classed SiteClass
                  &#39;memberTable&#39; =&gt; &quot;members&quot;, 
                  &#39;headFile&#39; =&gt; SITE_INCLUDES.&quot;/head.i.php&quot;,
                  &#39;bannerFile&#39; =&gt; SITE_INCLUDES.&quot;/banner.i.php&quot;,
                  footerFile =&gt; SITE_INCLUDES.&quot;/footer.i.php&quot;,
                  &#39;dbinfo&#39; =&gt; array(&#39;database&#39; =&gt; &#39;test.sdb&#39;, &#39;engine&#39; =&gt; &#39;sqlite3&#39;),
                  &#39;count&#39; =&gt; false,
                  &#39;countMe&#39; =&gt; true, // Count BLP
                  &#39;myUri&#39; =&gt; &quot;bartonphillips.dyndns.org&quot;
                 );</code></pre>
<p>In the abovd example I have used the SITE_INCLUDES define from the .sitemap.php's first section.</p>
<p>There is a default for the &lt;head&gt;, banner and footer section if you do not have special files. The DOCTYPE is by default <!DOCTYPE html> but that can be altered via an argument to the getPageTopBottom method ($h-&gt;doctype='xxx').</p>
<p>Creating the special files make the tedious boiler plate simple and yet configureable via the $arg array.</p>
<hr>


<h1 id="tests">Tests</h1>
<p>In the 'tests' directory there are a series of mostly database engine tests. If you want to test MySql or PostgresSql you will need to first install the packages (both OS and PHP5) and then configure each with a user and password etc. Setting up the databases is beyond the scope of this README. The tests are set up for an account with user 'siteclass' and password 'siteclass' with database 'siteclass' (no single quotes of course).</p>
<hr>


<h1 id="class-methods">Class Methods</h1>
<p>While there are a number of methods for each of the major classes there are really only a small handful you will use on a regular bases. The ones most used have some documentation with them.</p>
<h2 id="siteclass-methods">SiteClass methods:</h2>
<ul>
<li>constructor<br /></li>
<li>public function setSiteCookie($cookie, $value, $expire, $path=&quot;/&quot;)<br /></li>
<li>public function setIdCookie($id, $cookie=null)<br /></li>
<li>public function checkId($mid=null, $cookie=null) // if a memberTable<br /></li>
<li>public function getId() // if a memberTable<br /></li>
<li>public function setId($id) // if a memberTable<br /></li>
<li>public function getIp()<br /></li>
<li>public function getEmail() // if a memberTable<br /></li>
<li>public function setEmail($email) // if a memberTable<br /></li>
<li>public function getWhosBeenHereToday() // if a memberTable<br /></li>
<li>public function getPageTopBottom($h, $b=null)<br />This is the most used method. It takes one or two arguments which can be string|array|object.<br />$h can have 'title', 'desc', 'banner' and a couple of other less used options.<br />$b is for the footer or bottom. I sometimes pass a &lt;hr&gt; but you can also pass a 'msg', 'msg1', 'msg2' (see the code). I usually put things into the 'footerFile' but on occasions a page needs something extra.<br />This method calls getPageHead(), getBanner(), getFooter().<br /></li>
<li>public function getPageTop($header, $banner=null, $bodytag=null)<br /></li>
<li>public function getDoctype()<br /></li>
<li>public function getPageHead(/<em>$title, $desc=null, $extra=null, $doctype, $lang</em>/)<br /></li>
<li>public function getBanner($mainTitle, $nonav=false, $bodytag=null)<br /></li>
<li>public function getFooter(/* mixed */)<br /></li>
<li>public function __toString()<br /></li>
<li>A number of 'protected' methods and properties that can be used in a child class.</li>
</ul>
<h2 id="database-methods">Database methods:</h2>
<ul>
<li>constructor<br /></li>
<li>public function getDb()<br /></li>
<li>public function query($query)<br />This is the workhourse of the database. It is used for 'select', 'update', 'insert' and basically anything you need to do like 'drop', 'alter' etc. $query is the sql statement.<br /></li>
<li>public function fetchrow($result=null, $type=&quot;both&quot;)<br />Probably the second most used method. If it follows the 'query' the $result is not needed. The only time $result is needed is if there are other queries in a while loop. In that case you need to get the result of the query by calling the getResult() method before running the while loop.<br />The $type can be 'assoc', 'num' or default 'both'. 'assoc' returns only an associative array, while 'num' return a numeric array. I usually use a numeric array with</li>
</ul>
<pre class="sourceCode php"><code class="sourceCode php">while(list($name, $email) = $S-&gt;fetchrow(&#39;num&#39;)) { ... }</code></pre>
<ul>
<li>public function queryfetch($query, $retarray=false)<br /></li>
<li>public function getLastInsertId()<br />After an 'insert' this method returns the new row primary key id.<br /></li>
<li>public function getResult()<br />Returns the result object from the last 'query'. Usually not needed.<br /></li>
<li>public function escape($string)<br /></li>
<li>public function escapeDeep($value)<br /></li>
<li>public function getNumRows($result=null)<br /></li>
<li>public function prepare($query)<br />I hardly ever use prepare(), bindParam(), bindResults() or execute() so they are not as well tested as the other methods.<br /></li>
<li>public function bindParam($format)<br /></li>
<li>public function bindResults($format)<br /></li>
<li>public function execute()<br /></li>
<li>public function getErrorInfo()</li>
</ul>
<p>The database methods are implemented for all supported engines. There are some minor behavioral differences, for example in the syntax the engine queries uses or the return values. For example sqlite3 does not support a number of rows returned functionality and there are also several (many) syntactial differenced between sqlite and mysql when it comes to supported functions etc. (caviat emptor).</p>
<h2 id="dbtables-methods">dbTables methods:</h2>
<ul>
<li>constructor<br /></li>
<li>public function makeresultrows($query, $rowdesc, array $extra=array())<br /></li>
<li>public function maketable($query, array $extra=null)<br />$extra is an optional assoc array: $extra['callback'], $extra['callback2'], $extra['footer'] and $extra['attr'].<br />$extra['attr'] is an assoc array that can have attributes for the <table> tag, like 'id', 'title', 'class', 'style' etc.<br />$extra['callback'] function that can modify the header after it is filled in.<br />$extra['footer'] a footer string<br />@return array [{string table}, {result}, {num}, {hdr}, table=&gt;{string}, result=&gt;{result},<br /> num=&gt;{num rows}, header=&gt;{hdr}]<br /> or === false</li>
</ul>
<h2 id="contact-me">Contact Me</h2>
<p>Barton Phillips : <a href="mailto://bartonphillips@gmail.com">bartonphillips@gmail.com</a><br />Copyright Â© 2015 Barton Phillips</p>

</body>
</html>
