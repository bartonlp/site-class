<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Analysis</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  
  <style>
  div.sourceCode {
    background-color: #EEF3E2;
    border-left: 10px solid gray;
    padding-left: 5px;
  }
  code {
    background-color: #EEF3E2;
  }
  </style>
</head>
<body>
<h1 id="page-counting-analysis-and-tracking">Page Counting, Analysis and Tracking</h1>
<hr />
<h2 id="analysis-and-tracking-with-mysql">Analysis and Tracking with MySql</h2>
<p>If you want to do page counting and analysis there are several MySql tables that you can use. The MySql schema for these tables is in the <em>mysql.schema</em> file in the repository.</p>
<p>The tables are:</p>
<ul>
<li>bots : the SiteClass has logic to try to determin which user agents might be robots.</li>
<li>bots2 : similar to bots but has a 'site' and 'date' field.</li>
<li>logagent : logs the IpAddress, and User Agent.</li>
<li>logagent2 : a short term version of lagagent.</li>
<li>daycounts : counts the number of hits per day</li>
<li>counter : counts the number of hits per site per file.</li>
<li>counter2 : counts the number of hits per site per file per day.</li>
<li>tracker : trackes accesses by site, page etc.</li>
</ul>
<p>Here are the schemas of the tables:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `bots` (</a>
<a class="sourceLine" id="cb1-2" title="2">  `ip` <span class="dt">varchar</span>(<span class="dv">40</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-3" title="3">  `agent` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">  `count` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-5" title="5">  `robots` <span class="dt">int</span>(<span class="dv">5</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-6" title="6">  `who` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-7" title="7">  `creation_time` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-8" title="8">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`ip`,`agent`),</a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="kw">KEY</span> `ip` (`ip`)</a>
<a class="sourceLine" id="cb1-11" title="11">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `bots2` (</a>
<a class="sourceLine" id="cb1-14" title="14">  `ip` <span class="dt">varchar</span>(<span class="dv">40</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-15" title="15">  `agent` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-16" title="16">  `date` <span class="dt">date</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;0000-00-00&#39;</span>,</a>
<a class="sourceLine" id="cb1-17" title="17">  `site` <span class="dt">varchar</span>(<span class="dv">50</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-18" title="18">  `which` <span class="dt">int</span>(<span class="dv">5</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-19" title="19">  `count` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-20" title="20">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-21" title="21">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`ip`,`agent`,`date`,`site`,`which`),</a>
<a class="sourceLine" id="cb1-22" title="22">  <span class="kw">KEY</span> `ip` (`ip`),</a>
<a class="sourceLine" id="cb1-23" title="23">  <span class="kw">KEY</span> `agent` (`agent`),</a>
<a class="sourceLine" id="cb1-24" title="24">  <span class="kw">KEY</span> `site` (`site`),</a>
<a class="sourceLine" id="cb1-25" title="25">  <span class="kw">KEY</span> `ip_2` (`ip`),</a>
<a class="sourceLine" id="cb1-26" title="26">  <span class="kw">KEY</span> `date` (`date`),</a>
<a class="sourceLine" id="cb1-27" title="27">  <span class="kw">KEY</span> `site_2` (`site`)</a>
<a class="sourceLine" id="cb1-28" title="28">) ENGINE<span class="op">=</span>InnoDB <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-29" title="29"></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `logagent` (</a>
<a class="sourceLine" id="cb1-31" title="31">  `site` <span class="dt">varchar</span>(<span class="dv">25</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-32" title="32">  `ip` <span class="dt">varchar</span>(<span class="dv">40</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-33" title="33">  `agent` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-34" title="34">  `count` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-35" title="35">  `id` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-36" title="36">  `created` datetime <span class="kw">DEFAULT</span> <span class="st">&#39;0000-00-00 00:00:00&#39;</span>,</a>
<a class="sourceLine" id="cb1-37" title="37">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-38" title="38">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`site`,`ip`,`agent`),</a>
<a class="sourceLine" id="cb1-39" title="39">  <span class="kw">KEY</span> `ip` (`ip`),</a>
<a class="sourceLine" id="cb1-40" title="40">  <span class="kw">KEY</span> `site` (`site`),</a>
<a class="sourceLine" id="cb1-41" title="41">  <span class="kw">KEY</span> `agent` (`agent`)</a>
<a class="sourceLine" id="cb1-42" title="42">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-43" title="43"></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `logagent2` (</a>
<a class="sourceLine" id="cb1-45" title="45">  `site` <span class="dt">varchar</span>(<span class="dv">25</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-46" title="46">  `ip` <span class="dt">varchar</span>(<span class="dv">40</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-47" title="47">  `agent` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-48" title="48">  `count` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-49" title="49">  `id` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-50" title="50">  `created` datetime <span class="kw">DEFAULT</span> <span class="st">&#39;0000-00-00 00:00:00&#39;</span>,</a>
<a class="sourceLine" id="cb1-51" title="51">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-52" title="52">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`site`,`ip`,`agent`),</a>
<a class="sourceLine" id="cb1-53" title="53">  <span class="kw">KEY</span> `agent` (`agent`),</a>
<a class="sourceLine" id="cb1-54" title="54">  <span class="kw">KEY</span> `site` (`site`),</a>
<a class="sourceLine" id="cb1-55" title="55">  <span class="kw">KEY</span> `ip` (`ip`)</a>
<a class="sourceLine" id="cb1-56" title="56">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-57" title="57"></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `daycounts` (</a>
<a class="sourceLine" id="cb1-59" title="59">  `site` <span class="dt">varchar</span>(<span class="dv">50</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-60" title="60">  `date` <span class="dt">date</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-61" title="61">  `real` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-62" title="62">  `bots` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-63" title="63">  `members` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-64" title="64">  `visits` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-65" title="65">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-66" title="66">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`site`,`date`)</a>
<a class="sourceLine" id="cb1-67" title="67">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-68" title="68"></a>
<a class="sourceLine" id="cb1-69" title="69"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `counter` (</a>
<a class="sourceLine" id="cb1-70" title="70">  `filename` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-71" title="71">  `site` <span class="dt">varchar</span>(<span class="dv">50</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-72" title="72">  `ip` <span class="dt">varchar</span>(<span class="dv">20</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-73" title="73">  `agent` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-74" title="74">  `count` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-75" title="75">  `realcnt` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-76" title="76">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-77" title="77">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`filename`,`site`),</a>
<a class="sourceLine" id="cb1-78" title="78">  <span class="kw">KEY</span> `site` (`site`)</a>
<a class="sourceLine" id="cb1-79" title="79">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-80" title="80"></a>
<a class="sourceLine" id="cb1-81" title="81"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `counter2` (</a>
<a class="sourceLine" id="cb1-82" title="82">  `site` <span class="dt">varchar</span>(<span class="dv">50</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-83" title="83">  `date` <span class="dt">date</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;0000-00-00&#39;</span>,</a>
<a class="sourceLine" id="cb1-84" title="84">  `filename` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-85" title="85">  `count` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-86" title="86">  `members` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-87" title="87">  `bots` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-88" title="88">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-89" title="89">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`site`,`date`,`filename`),</a>
<a class="sourceLine" id="cb1-90" title="90">  <span class="kw">KEY</span> `site` (`site`),</a>
<a class="sourceLine" id="cb1-91" title="91">  <span class="kw">KEY</span> `date` (`date`)</a>
<a class="sourceLine" id="cb1-92" title="92">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a>
<a class="sourceLine" id="cb1-93" title="93"></a>
<a class="sourceLine" id="cb1-94" title="94"><span class="kw">CREATE</span> <span class="kw">TABLE</span> `tracker` (</a>
<a class="sourceLine" id="cb1-95" title="95">  `id` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> AUTO_INCREMENT,</a>
<a class="sourceLine" id="cb1-96" title="96">  `site` <span class="dt">varchar</span>(<span class="dv">25</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-97" title="97">  `page` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb1-98" title="98">  `ip` <span class="dt">varchar</span>(<span class="dv">40</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-99" title="99">  `agent` <span class="dt">varchar</span>(<span class="dv">255</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-100" title="100">  `starttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-101" title="101">  `endtime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-102" title="102">  `difftime` <span class="dt">time</span> <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-103" title="103">  `refid` <span class="dt">int</span>(<span class="dv">11</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-104" title="104">  `isJavaScript` <span class="dt">int</span>(<span class="dv">5</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;0&#39;</span>,</a>
<a class="sourceLine" id="cb1-105" title="105">  `lasttime` datetime <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</a>
<a class="sourceLine" id="cb1-106" title="106">  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (`id`),</a>
<a class="sourceLine" id="cb1-107" title="107">  <span class="kw">KEY</span> `site` (`site`),</a>
<a class="sourceLine" id="cb1-108" title="108">  <span class="kw">KEY</span> `ip` (`ip`),</a>
<a class="sourceLine" id="cb1-109" title="109">  <span class="kw">KEY</span> `agent` (`agent`)</a>
<a class="sourceLine" id="cb1-110" title="110">) ENGINE<span class="op">=</span>MyISAM <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8;</a></code></pre></div>
<p>If you look at <em>SiteClass</em> you will see several methods in the constructor:</p>
<ul>
<li>$this-&gt;trackbots();</li>
<li>$this-&gt;tracker();</li>
<li>$this-&gt;doanalysis();</li>
<li>$this-&gt;logagent();</li>
<li>$this-&gt;counter();</li>
</ul>
<p>If you look at these methods you will see that they are protected by a check of the database to see if the tables exists in the database. If the table does not exist an 'error_log' message is output. You can prevent the error message by setting "noErrorLog": "true" in the 'mysitemap.json' file.</p>
<h2 id="additional-files-for-tracking">Additional Files for Tracking</h2>
<p>I have five additional PHP files to check <em>robots.txt</em> (robots.php) and <em>Sitemap.xml</em> (sitemap.php). I also have a 'tracker.php', 'beacon.php' and 'tracker.js' to do session logging. These file are here in the 'docs/' directory.</p>
<p>If you want to track reads of <em>robots.txt</em> and <em>Sitemap.xml</em> you can add 'RewriteRule' clauses to your '.htaccess' file:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># direct robots.txt to robots.php and Sitemap.xml to sitemap.php</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="ex">RewriteRule</span> ^robots\.txt$ robots.php [L,NC]</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="ex">RewriteRule</span> ^Sitemap\.xml$ sitemap.php [L,NC]</a></code></pre></div>
<p>If you want to do tracking you can include the 'tracker.js' file in the <em>php</em> head section in your 'head.i.php' file.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode php"><code class="sourceCode php"><a class="sourceLine" id="cb3-1" title="1">&lt;head&gt;</a>
<a class="sourceLine" id="cb3-2" title="2">  &lt;!-- Other head stuff in the head.i.php <span class="fu">file</span> --&gt;</a>
<a class="sourceLine" id="cb3-3" title="3">  &lt;!-- jQuery is required <span class="kw">for</span> tracker.js --&gt;</a>
<a class="sourceLine" id="cb3-4" title="4">  &lt;script src=<span class="st">&quot;http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js&quot;</span>&gt;&lt;/script&gt;</a>
<a class="sourceLine" id="cb3-5" title="5">  &lt;!-- set the <span class="st">&#39;lastId&#39;</span> variable to <span class="kw">$this</span>-&gt;<span class="kw">LAST_ID</span>. This is the <span class="st">&#39;id&#39;</span> <span class="fu">key</span> of the entry in the <span class="st">&#39;tracker&#39;</span> table --&gt;</a>
<a class="sourceLine" id="cb3-6" title="6">  &lt;script&gt;</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="er">var</span> lastId = <span class="kw">$this</span>-&gt;<span class="kw">LAST_ID</span><span class="ot">;</span></a>
<a class="sourceLine" id="cb3-8" title="8">  &lt;/script&gt;</a>
<a class="sourceLine" id="cb3-9" title="9">  &lt;script src=<span class="st">&quot;js/tracker.js&quot;</span>&gt;&lt;/script&gt;</a>
<a class="sourceLine" id="cb3-10" title="10">  &lt;!-- Other stuff --&gt;</a></code></pre></div>
<p>The 'tracker.js' will use AJAX to communicate with the 'tracker.php' and 'beacon.php' files. These files track the progress of the session and use 'unload' to capture the end of the session. Look at the two <em>php</em> files for more information. From the information in the MySql tables you could create a <em>php</em> file that could show the tracking information. I do this on my website so take a look at <a href="http://www.bartonphillips.com">www.bartonphillips.com</a>.</p>
<h2 id="page-counting">Page Counting</h2>
<p>If you want a page counter you can add '$counterWigget' to your 'footer.i.php' file. You can pass arguments via the <code>$S-&gt;getPageTopBottom($h, $b);</code> by passing a '$b' array. You can pass 'msg', 'msg1', 'msg2' and 'ctrmsg'. Or of course anything else you might want in your footer. The 'ctrmsg' is inserted just above the counter so you can add a reset message like "Counter Reset: 2016-03-27".</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode php"><code class="sourceCode php"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">return</span> <span class="kw">&lt;&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">&lt;footer&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">&lt;!-- Other footer stuff like address, copyright etc. --&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">{$arg[&#39;msg&#39;]}</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">{</span><span class="kw">$arg</span><span class="st">[&#39;msg1&#39;]} </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">$counterWigget</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">{</span><span class="kw">$arg</span><span class="st">[&#39;msg2&#39;]}</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="st">&lt;/footer&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">&lt;/html&gt;</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="st">EOF;</span></a></code></pre></div>
<p>The '$counterWigget' has <em>css</em> to render the counter.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb5-1" title="1"><span class="co">/* Example CSS for the counterWigget */</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">/* #hitCounter is a div wrapper around the entire counter */</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="pp">#hitCounter</span> {</a>
<a class="sourceLine" id="cb5-4" title="4">        <span class="kw">margin-left</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5">        <span class="kw">margin-right</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6">        <span class="kw">width</span>: <span class="dv">50</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-7" title="7">        <span class="kw">text-align</span>: <span class="dv">center</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-8" title="8">}</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">/* #hitCountertbl is the table that holds the counter */</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="pp">#hitCountertbl</span> {</a>
<a class="sourceLine" id="cb5-11" title="11">        <span class="kw">font-size</span>: <span class="dv">1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-12" title="12">        <span class="kw">width</span>: <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-13" title="13">        <span class="kw">border</span>: <span class="dv">8</span><span class="dt">px</span> <span class="dv">ridge</span> <span class="cn">yellow</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-14" title="14">        <span class="kw">margin-left</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-15" title="15">        <span class="kw">margin-right</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-16" title="16">        <span class="kw">background-color</span>: <span class="cn">#F5DEB3</span></a>
<a class="sourceLine" id="cb5-17" title="17">}</a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">/* #hitcountertr is the tr tag that holds the counter */</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="pp">#hitCountertr</span> {</a>
<a class="sourceLine" id="cb5-20" title="20">        <span class="kw">width</span>: <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-21" title="21">        <span class="kw">border</span>: <span class="dv">8</span><span class="dt">px</span> <span class="dv">ridge</span> <span class="cn">yellow</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-22" title="22">        <span class="kw">margin-left</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-23" title="23">        <span class="kw">margin-right</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-24" title="24">        <span class="kw">background-color</span>: <span class="cn">#F5DEB3</span></a>
<a class="sourceLine" id="cb5-25" title="25">}</a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">/* #hitCounterth is the th tag that holds the counter */</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="pp">#hitCounterth</span> {</a>
<a class="sourceLine" id="cb5-28" title="28">        <span class="kw">color</span>: <span class="fu">rgb(</span><span class="dv">123</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">66</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-29" title="29">}</a></code></pre></div>
<p>The above code created a centered table with a yellow 8 pixel ridge border, a light orangeish background and deep redish numbers.</p>
<p><img src="counter.png" alt="Counter" /></p>
<p>Using the above <em>css</em> you can create almost any type of counter you want.</p>
<hr />
<p><a href="examples.html">Examples</a> <a href="dbTables.html">dbTables</a> <a href="siteclass.html">SiteClass Methods</a> <a href="files.html">Additional Files</a> <a href="analysis.html">Analysis and Tracking</a> <a href="index.html">Index</a></p>
<h2 id="contact-me">Contact Me</h2>
<p>Barton Phillips : <a href="mailto://bartonphillips@gmail.com">bartonphillips@gmail.com</a><br />
Copyright Â© 2022 Barton Phillips<br />
Project maintained by <a href="https://github.com/bartonlp">bartonlp</a> Last Modified Aug 14, 2022</p>
</body>
</html>
